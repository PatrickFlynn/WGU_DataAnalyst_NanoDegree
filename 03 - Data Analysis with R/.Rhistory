"VIC_UNDERAGE",
"VIC_OVERSIXTYONE",
"PROPERTY",
"X",
"Y"
)]
##testing
# matrix$RPT_DATE <- as.POSIXct(matrix$RPT_DATE)
# matrix$RPT_DATE <- paste(substr(matrix$RPT_DATE, 6, 7), "/", substr(matrix$RPT_DATE, 9, 10), "/", substr(matrix$RPT_DATE, 1, 4), sep="")
matrix$TOTAL_SUSPECTS <- as.integer(matrix$TOTAL_SUSPECTS)
Book <- loadWorkbook("RobberyData.xlsx", create=TRUE)
createSheet(Book, name = "Data")
createSheet(Book, name = "Suspect")
createSheet(Book, name = "Property")
writeWorksheet(Book, matrix, sheet = "Data")
writeWorksheet(Book, suspectData, sheet = "Suspect")
writeWorksheet(Book, propertyData, sheet = "Property")
saveWorkbook(Book, "RobberyData.xlsx")
rm(AC, age, Book, hr, ht_wt_age, i, j, race, race_sex, sex, singleEvent,
suspect, suspects, temp, test, victim, victims,
k , l, items, event, testone, thisLength, type, m, p, fullItem, propertyTypeList, testVec, cleanedSuspectList, eventIndex,
eventSuspects, fullSuspect, suspMetrics, suspName, suspRS, extractSuspElements, parseMetrics, parseSuspName,
prepareSuspString, parseRaceSex)
print("Complete!")
library(readxl)
library(stringr)
library(lubridate)
#library(xlsx)
library(XLConnect)
if(file.exists("RobberyData.xlsx") == TRUE){
file.remove("RobberyData.xlsx")
}
matrix <- read_excel("C:/Users/p15144f/Desktop/NEW ROBBERY DATA.xlsx")
matrix <-matrix[c("EVENT_NUM", "CV_BUILDING_ADDRESS", "PREMISE", "MO_S_PREM1", "CV_ADDRESS", "COMMAND", "SECTORBEAT", "RPT_DATE", "FROM_DATE", "COMBINED_WEAP_FORCE", "WEAPON_FROM_NAR", "SUSPECTS", "VICTIM_INFO", "ATTEMPT", "PROPERTY", "X", "Y")]
matrix[which(matrix$SUSPECTS == "<Null>"),]$SUSPECTS <- NA
matrix[which(matrix$SUSPECTS == "UNK"),]$SUSPECTS <- NA
matrix$PREMISE <- ""
matrix$MO_S_PREM1 <- ""
matrix$COMBINED_WEAP_FORCE <- ""
matrix$WEAPON_FROM_NAR <- ""
matrix$DOW <- ""
matrix$NARRATIVE <- ""
matrix$REPORT_DATE <- ""
matrix$VIOLENCE <- ""
matrix$SECONDARY_WEAPON <- ""
matrix$ARRESTED <- ""
matrix$VIC_RACE <- ""
matrix$VIC_SEX <- ""
matrix$VIC_AGE <- ""
matrix$RACE_SEX <- ""
matrix$HT_WT_AGE <- ""
matrix$TOTAL_SUSPECTS <- ""
matrix$SUSP_UNDERAGE <- "N"
matrix$HR <- hour(matrix$FROM_DATE)
matrix$DOW <- wday(matrix$FROM_DATE, label = TRUE, abbr = TRUE)
matrix$DOW <- toupper(strtrim(matrix$DOW,3))
matrix$TIME <- substr(matrix$FROM_DATE, 12, 16)
matrix$SHIFT <- ""
matrix$DATE <- as.Date(matrix$FROM_DATE, format="%m/%d/%y")
matrix$VIC_UNDERAGE <- "N"
matrix$VIC_OVERSIXTYONE <- "N"
matrix$SECONDARY_WEP <- ""
matrix$UNIQUE_CHAR <- ""
matrix$SUSP_VEH <- ""
matrix$CARJACKING <- ""
matrix$PROPERTY2 <- ""
matrix$NOTES <- ""
matrix$MONTH <- ""
matrix$RPT_DATE <- as.character(matrix$RPT_DATE)
matrix$ATTEMPT <- gsub("O", "", matrix$ATTEMPT)
matrix$COMMAND <- gsub("BOLDEN", "BA", matrix$COMMAND)
matrix$COMMAND <- gsub("CONVENTION CENTER", "CC", matrix$COMMAND)
matrix$COMMAND <- gsub("DOWNTOWN", "DT", matrix$COMMAND)
matrix$COMMAND <- gsub("ENTERPRISE", "EA", matrix$COMMAND)
matrix$COMMAND <- gsub("NORTHEAST", "NE", matrix$COMMAND)
matrix$COMMAND <- gsub("NORTHWEST", "NW", matrix$COMMAND)
matrix$COMMAND <- gsub("SOUTH CENTRAL", "SC", matrix$COMMAND)
matrix$COMMAND <- gsub("SOUTHEAST", "SE", matrix$COMMAND)
matrix$COMMAND <- gsub("SPRING VALLEY", "SV", matrix$COMMAND)
i <- 1
for(AC in matrix$COMMAND){
if(AC %in% c("BA", "CC", "DT", "EA", "NE", "NW", "SC", "SE", "SV") == FALSE){
matrix$COMMAND[i] <- "RES/UNK/Q"
}
i <- i+1
}
matrix$CV_BUILDING_ADDRESS <- gsub("<Null>", "", matrix$CV_BUILDING_ADDRESS)
matrix$SUSPECTS <- gsub("<Null>", "", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("BLACK OR AFRICAN AMERICAN  MALE", "BMA", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("BLACK OR AFRICAN AMERICAN  FEMALE", "BFA", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("NOT HISPANIC OR LATINO", "", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("WHITE  MALE", "WMA", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("WHITE  FEMALE", "WFA", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("UNKNOWN  MALE", "UMA", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("ASIAN, INDIAN, SAMOAN, PACIFIC ISLANDER  MALE", "AMA", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("ASIAN, INDIAN, SAMOAN, PACIFIC ISLANDER  FEMALE", "AFA", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("AMERICAN INDIAN OR ALASKA NATIVE  MALE", "AMA", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("AMERICAN INDIAN OR ALASKA NATIVE  FEMALE", "AFA", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("UNKNOWN", "", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("UNK", "", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("SUSPECTS: ,", "", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("SUSPECTS: ", "", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("(?<=[\\s])\\s*|^\\s+|\\s+$", "", matrix$SUSPECTS, perl=TRUE)
source("SuspectData.R")
#Victims
matrix$VICTIM_INFO <- gsub("<Null>", "", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("BLACK OR AFRICAN AMERICAN  MALE", "BMA", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("BLACK OR AFRICAN AMERICAN  FEMALE", "BFA", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("NOT HISPANIC OR LATINO", "", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("WHITE  MALE", "WMA", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("WHITE  FEMALE", "WFA", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("UNKNOWN  MALE", "UMA", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("ASIAN, INDIAN, SAMOAN, PACIFIC ISLANDER  MALE", "AMA", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("ASIAN, INDIAN, SAMOAN, PACIFIC ISLANDER  FEMALE", "AFA", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("AMERICAN INDIAN OR ALASKA NATIVE  MALE", "AMA", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("AMERICAN INDIAN OR ALASKA NATIVE  FEMALE", "AFA", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("UNKNOWN", "", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("UNK", "", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("SUSPECTS: ,", "", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("SUSPECTS: ", "", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("(?<=[\\s])\\s*|^\\s+|\\s+$", "", matrix$VICTIM_INFO, perl=TRUE)
i <- 1
for(hr in matrix$HR){
if(hr < 8){
matrix$SHIFT[i] <- "GRAVE"
}else if(hr < 16){
matrix$SHIFT[i] <- "DAY"
}else{
matrix$SHIFT[i] <- "SWING"
}
i <- i+1
}
source("Suspect.R")
#VictimAutomator
i <- 1
for (singleEvent in matrix$VICTIM_INFO){
temp <- strsplit(singleEvent, "//")
j <- 1
race <- c()
sex <- c()
age <- c()
for(victim in singleEvent[[1]]){
victim <- strsplit(victim, "//")
test <- unlist(victim, " ")
for(victims in test){
victims <- strsplit(victims, " ")
victims <- unlist(victims, " ")
if(TRUE %in% (victims %in% c("BMA", "BFA", "WMA", "WFA", "AMA", "AFA", "UMA", "UFA")) == TRUE){
while(!victims[1] %in% c("BMA", "BFA", "WMA", "WFA", "AMA", "AFA", "UMA", "UFA")){
victims <- victims[-1]
}
if (TRUE %in% (victims %in% c("HISPANIC", "LATINO")) == TRUE){
str_sub(victims[1], 1,1) <- "H"
}
victims <- paste(victims, collapse=" ")
}
victims <- str_replace_all(victims, "HISPANIC OR LATINO","")
victims <- str_replace_all(victims, "\"", "")
victims <- str_replace_all(victims, " - ", "-")
victims <- str_replace_all(victims, "' ", "'")
victims <- strsplit(victims, " ")
victims <- unlist(victims, " ")
if (victims[1] %in% c("BMA", "BFA", "WMA", "WFA", "AMA", "AFA", "UMA", "UFA", "HMA", "HFA")){
race[j] <- str_sub(victims[1], 1,1)
sex[j] <- str_sub(victims[1], 2,2)
age[j] <- victims[2]
if (is.na(as.integer(age[j])) == FALSE){
if(as.integer(age[j]) < 18){
matrix$VIC_UNDERAGE[i] <- "Y"
}
}
if (is.na(as.integer(age[j])) == FALSE){
if(as.integer(age[j]) >= 61){
matrix$VIC_OVERSIXTYONE[i] <- "Y"
}
}
victims <- victims[-1]
victims <- victims[victims != ""]
victims <- paste(victims, collapse=" ")
}
j <- j+1
}
race <- (unlist(race))
race <- paste(race, collapse="/")
matrix$VIC_RACE[i] <- race
sex <- (unlist(sex))
sex <- paste(sex, collapse="/")
matrix$VIC_SEX[i] <- sex
age <- (unlist(age))
age <- paste(age, collapse="/")
matrix$VIC_AGE[i] <- age
}
i <- i+1
}
source("Property.r")
matrix <-matrix[
c("EVENT_NUM",
"COMMAND",
"PREMISE",
"MO_S_PREM1",
"COMBINED_WEAP_FORCE",
"MONTH",
"NARRATIVE",
"VIOLENCE",
"WEAPON_FROM_NAR",
"SECONDARY_WEP",
"UNIQUE_CHAR",
"SUSP_VEH",
"ATTEMPT",
"CARJACKING",
"NOTES",
"CV_BUILDING_ADDRESS",
"CV_ADDRESS",
"SECTORBEAT",
"RPT_DATE",
"DOW",
"TIME",
"HR",
"SHIFT",
"DATE",
"TOTAL_SUSPECTS",
"RACE_SEX",
"HT_WT_AGE",
"SUSP_UNDERAGE",
"ARRESTED",
"VIC_RACE",
"VIC_SEX",
"VIC_AGE",
"VIC_UNDERAGE",
"VIC_OVERSIXTYONE",
"PROPERTY",
"X",
"Y"
)]
##testing
# matrix$RPT_DATE <- as.POSIXct(matrix$RPT_DATE)
# matrix$RPT_DATE <- paste(substr(matrix$RPT_DATE, 6, 7), "/", substr(matrix$RPT_DATE, 9, 10), "/", substr(matrix$RPT_DATE, 1, 4), sep="")
matrix$TOTAL_SUSPECTS <- as.integer(matrix$TOTAL_SUSPECTS)
Book <- loadWorkbook("RobberyData.xlsx", create=TRUE)
createSheet(Book, name = "Data")
createSheet(Book, name = "Suspect")
createSheet(Book, name = "Property")
writeWorksheet(Book, matrix, sheet = "Data")
writeWorksheet(Book, suspectData, sheet = "Suspect")
writeWorksheet(Book, propertyData, sheet = "Property")
saveWorkbook(Book, "RobberyData.xlsx")
rm(AC, age, Book, hr, ht_wt_age, i, j, race, race_sex, sex, singleEvent,
suspect, suspects, temp, test, victim, victims,
k , l, items, event, testone, thisLength, type, m, p, fullItem, propertyTypeList, testVec, cleanedSuspectList, eventIndex,
eventSuspects, fullSuspect, suspMetrics, suspName, suspRS, extractSuspElements, parseMetrics, parseSuspName,
prepareSuspString, parseRaceSex)
print("Complete!")
suspectData$AGE_MIN
library(readxl)
library(stringr)
library(lubridate)
#library(xlsx)
library(XLConnect)
if(file.exists("RobberyData.xlsx") == TRUE){
file.remove("RobberyData.xlsx")
}
matrix <- read_excel("C:/Users/p15144f/Desktop/NEW ROBBERY DATA.xlsx")
matrix <-matrix[c("EVENT_NUM", "CV_BUILDING_ADDRESS", "PREMISE", "MO_S_PREM1", "CV_ADDRESS", "COMMAND", "SECTORBEAT", "RPT_DATE", "FROM_DATE", "COMBINED_WEAP_FORCE", "WEAPON_FROM_NAR", "SUSPECTS", "VICTIM_INFO", "ATTEMPT", "PROPERTY", "X", "Y")]
matrix[which(matrix$SUSPECTS == "<Null>"),]$SUSPECTS <- NA
matrix[which(matrix$SUSPECTS == "UNK"),]$SUSPECTS <- NA
matrix$PREMISE <- ""
matrix$MO_S_PREM1 <- ""
matrix$COMBINED_WEAP_FORCE <- ""
matrix$WEAPON_FROM_NAR <- ""
matrix$DOW <- ""
matrix$NARRATIVE <- ""
matrix$REPORT_DATE <- ""
matrix$VIOLENCE <- ""
matrix$SECONDARY_WEAPON <- ""
matrix$ARRESTED <- ""
matrix$VIC_RACE <- ""
matrix$VIC_SEX <- ""
matrix$VIC_AGE <- ""
matrix$RACE_SEX <- ""
matrix$HT_WT_AGE <- ""
matrix$TOTAL_SUSPECTS <- ""
matrix$SUSP_UNDERAGE <- "N"
matrix$HR <- hour(matrix$FROM_DATE)
matrix$DOW <- wday(matrix$FROM_DATE, label = TRUE, abbr = TRUE)
matrix$DOW <- toupper(strtrim(matrix$DOW,3))
matrix$TIME <- substr(matrix$FROM_DATE, 12, 16)
matrix$SHIFT <- ""
matrix$DATE <- as.Date(matrix$FROM_DATE, format="%m/%d/%y")
matrix$VIC_UNDERAGE <- "N"
matrix$VIC_OVERSIXTYONE <- "N"
matrix$SECONDARY_WEP <- ""
matrix$UNIQUE_CHAR <- ""
matrix$SUSP_VEH <- ""
matrix$CARJACKING <- ""
matrix$PROPERTY2 <- ""
matrix$NOTES <- ""
matrix$MONTH <- ""
matrix$RPT_DATE <- as.character(matrix$RPT_DATE)
matrix$ATTEMPT <- gsub("O", "", matrix$ATTEMPT)
matrix$COMMAND <- gsub("BOLDEN", "BA", matrix$COMMAND)
matrix$COMMAND <- gsub("CONVENTION CENTER", "CC", matrix$COMMAND)
matrix$COMMAND <- gsub("DOWNTOWN", "DT", matrix$COMMAND)
matrix$COMMAND <- gsub("ENTERPRISE", "EA", matrix$COMMAND)
matrix$COMMAND <- gsub("NORTHEAST", "NE", matrix$COMMAND)
matrix$COMMAND <- gsub("NORTHWEST", "NW", matrix$COMMAND)
matrix$COMMAND <- gsub("SOUTH CENTRAL", "SC", matrix$COMMAND)
matrix$COMMAND <- gsub("SOUTHEAST", "SE", matrix$COMMAND)
matrix$COMMAND <- gsub("SPRING VALLEY", "SV", matrix$COMMAND)
i <- 1
for(AC in matrix$COMMAND){
if(AC %in% c("BA", "CC", "DT", "EA", "NE", "NW", "SC", "SE", "SV") == FALSE){
matrix$COMMAND[i] <- "RES/UNK/Q"
}
i <- i+1
}
matrix$CV_BUILDING_ADDRESS <- gsub("<Null>", "", matrix$CV_BUILDING_ADDRESS)
matrix$SUSPECTS <- gsub("<Null>", "", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("BLACK OR AFRICAN AMERICAN  MALE", "BMA", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("BLACK OR AFRICAN AMERICAN  FEMALE", "BFA", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("NOT HISPANIC OR LATINO", "", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("WHITE  MALE", "WMA", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("WHITE  FEMALE", "WFA", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("UNKNOWN  MALE", "UMA", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("ASIAN, INDIAN, SAMOAN, PACIFIC ISLANDER  MALE", "AMA", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("ASIAN, INDIAN, SAMOAN, PACIFIC ISLANDER  FEMALE", "AFA", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("AMERICAN INDIAN OR ALASKA NATIVE  MALE", "AMA", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("AMERICAN INDIAN OR ALASKA NATIVE  FEMALE", "AFA", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("UNKNOWN", "", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("UNK", "", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("SUSPECTS: ,", "", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("SUSPECTS: ", "", matrix$SUSPECTS)
matrix$SUSPECTS <- gsub("(?<=[\\s])\\s*|^\\s+|\\s+$", "", matrix$SUSPECTS, perl=TRUE)
source("SuspectData.R")
#Victims
matrix$VICTIM_INFO <- gsub("<Null>", "", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("BLACK OR AFRICAN AMERICAN  MALE", "BMA", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("BLACK OR AFRICAN AMERICAN  FEMALE", "BFA", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("NOT HISPANIC OR LATINO", "", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("WHITE  MALE", "WMA", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("WHITE  FEMALE", "WFA", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("UNKNOWN  MALE", "UMA", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("ASIAN, INDIAN, SAMOAN, PACIFIC ISLANDER  MALE", "AMA", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("ASIAN, INDIAN, SAMOAN, PACIFIC ISLANDER  FEMALE", "AFA", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("AMERICAN INDIAN OR ALASKA NATIVE  MALE", "AMA", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("AMERICAN INDIAN OR ALASKA NATIVE  FEMALE", "AFA", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("UNKNOWN", "", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("UNK", "", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("SUSPECTS: ,", "", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("SUSPECTS: ", "", matrix$VICTIM_INFO)
matrix$VICTIM_INFO <- gsub("(?<=[\\s])\\s*|^\\s+|\\s+$", "", matrix$VICTIM_INFO, perl=TRUE)
i <- 1
for(hr in matrix$HR){
if(hr < 8){
matrix$SHIFT[i] <- "GRAVE"
}else if(hr < 16){
matrix$SHIFT[i] <- "DAY"
}else{
matrix$SHIFT[i] <- "SWING"
}
i <- i+1
}
source("Suspect.R")
#VictimAutomator
i <- 1
for (singleEvent in matrix$VICTIM_INFO){
temp <- strsplit(singleEvent, "//")
j <- 1
race <- c()
sex <- c()
age <- c()
for(victim in singleEvent[[1]]){
victim <- strsplit(victim, "//")
test <- unlist(victim, " ")
for(victims in test){
victims <- strsplit(victims, " ")
victims <- unlist(victims, " ")
if(TRUE %in% (victims %in% c("BMA", "BFA", "WMA", "WFA", "AMA", "AFA", "UMA", "UFA")) == TRUE){
while(!victims[1] %in% c("BMA", "BFA", "WMA", "WFA", "AMA", "AFA", "UMA", "UFA")){
victims <- victims[-1]
}
if (TRUE %in% (victims %in% c("HISPANIC", "LATINO")) == TRUE){
str_sub(victims[1], 1,1) <- "H"
}
victims <- paste(victims, collapse=" ")
}
victims <- str_replace_all(victims, "HISPANIC OR LATINO","")
victims <- str_replace_all(victims, "\"", "")
victims <- str_replace_all(victims, " - ", "-")
victims <- str_replace_all(victims, "' ", "'")
victims <- strsplit(victims, " ")
victims <- unlist(victims, " ")
if (victims[1] %in% c("BMA", "BFA", "WMA", "WFA", "AMA", "AFA", "UMA", "UFA", "HMA", "HFA")){
race[j] <- str_sub(victims[1], 1,1)
sex[j] <- str_sub(victims[1], 2,2)
age[j] <- victims[2]
if (is.na(as.integer(age[j])) == FALSE){
if(as.integer(age[j]) < 18){
matrix$VIC_UNDERAGE[i] <- "Y"
}
}
if (is.na(as.integer(age[j])) == FALSE){
if(as.integer(age[j]) >= 61){
matrix$VIC_OVERSIXTYONE[i] <- "Y"
}
}
victims <- victims[-1]
victims <- victims[victims != ""]
victims <- paste(victims, collapse=" ")
}
j <- j+1
}
race <- (unlist(race))
race <- paste(race, collapse="/")
matrix$VIC_RACE[i] <- race
sex <- (unlist(sex))
sex <- paste(sex, collapse="/")
matrix$VIC_SEX[i] <- sex
age <- (unlist(age))
age <- paste(age, collapse="/")
matrix$VIC_AGE[i] <- age
}
i <- i+1
}
source("Property.r")
matrix <-matrix[
c("EVENT_NUM",
"COMMAND",
"PREMISE",
"MO_S_PREM1",
"COMBINED_WEAP_FORCE",
"MONTH",
"NARRATIVE",
"VIOLENCE",
"WEAPON_FROM_NAR",
"SECONDARY_WEP",
"UNIQUE_CHAR",
"SUSP_VEH",
"ATTEMPT",
"CARJACKING",
"NOTES",
"CV_BUILDING_ADDRESS",
"CV_ADDRESS",
"SECTORBEAT",
"RPT_DATE",
"DOW",
"TIME",
"HR",
"SHIFT",
"DATE",
"TOTAL_SUSPECTS",
"RACE_SEX",
"HT_WT_AGE",
"SUSP_UNDERAGE",
"ARRESTED",
"VIC_RACE",
"VIC_SEX",
"VIC_AGE",
"VIC_UNDERAGE",
"VIC_OVERSIXTYONE",
"PROPERTY",
"X",
"Y"
)]
##testing
# matrix$RPT_DATE <- as.POSIXct(matrix$RPT_DATE)
# matrix$RPT_DATE <- paste(substr(matrix$RPT_DATE, 6, 7), "/", substr(matrix$RPT_DATE, 9, 10), "/", substr(matrix$RPT_DATE, 1, 4), sep="")
matrix$TOTAL_SUSPECTS <- as.integer(matrix$TOTAL_SUSPECTS)
Book <- loadWorkbook("RobberyData.xlsx", create=TRUE)
createSheet(Book, name = "Data")
createSheet(Book, name = "Suspect")
createSheet(Book, name = "Property")
writeWorksheet(Book, matrix, sheet = "Data")
writeWorksheet(Book, suspectData, sheet = "Suspect")
writeWorksheet(Book, propertyData, sheet = "Property")
saveWorkbook(Book, "RobberyData.xlsx")
rm(AC, age, Book, hr, ht_wt_age, i, j, race, race_sex, sex, singleEvent,
suspect, suspects, temp, test, victim, victims,
k , l, items, event, testone, thisLength, type, m, p, fullItem, propertyTypeList, testVec, cleanedSuspectList, eventIndex,
eventSuspects, fullSuspect, suspMetrics, suspName, suspRS, extractSuspElements, parseMetrics, parseSuspName,
prepareSuspString, parseRaceSex)
print("Complete!")
melted_matrix <- melt(round(cor(select(wine, -c("X"))),2))
ggplot(data=melted_matrix, aes(x=Var1, y=Var2, fill=value)) + geom_tile() + scale_fill_gradient(low="yellow", high="red")
library(ggplot2)
library(dplyr)
library(reshape2)
melted_matrix <- melt(round(cor(select(wine, -c("X"))),2))
ggplot(data=melted_matrix, aes(x=Var1, y=Var2, fill=value)) + geom_tile() + scale_fill_gradient(low="yellow", high="red")
melted_matrix <- melt(round(cor(select(wine, -c("X"))),2))
ggplot(data=melted_matrix, aes(x=Var1, y=Var2, fill=value)) + geom_tile() + scale_fill_gradient(low="yellow", high="red")
wine <- read.csv(file="wineQualityReds.csv",header=TRUE, sep=",")
melted_matrix <- melt(round(cor(select(wine, -c("X"))),2))
ggplot(data=melted_matrix, aes(x=Var1, y=Var2, fill=value)) + geom_tile() + scale_fill_gradient(low="yellow", high="red")
setwd("C:/Users/p15144f/Desktop/WGU_DataAnalyst_NanoDegree/03 - Data Analysis with R")
wine <- read.csv(file="wineQualityReds.csv",header=TRUE, sep=",")
library(ggplot2)
library(dplyr)
library(reshape2)
melted_matrix <- melt(round(cor(select(wine, -c("X"))),2))
ggplot(data=melted_matrix, aes(x=Var1, y=Var2, fill=value)) + geom_tile() + scale_fill_gradient(low="yellow", high="red")
unlink('RedWineAnalysisPatrickFlynn_cache', recursive = TRUE)
unlink('RedWineAnalysisPatrickFlynn_cache', recursive = TRUE)
View(melted_matrix)
winequal
winequal <- ggplot(data=wine, aes(x=quality, label=Name)) + geom_histogram(color='black', fill='#891e1e', binwidth=1, na.rm=TRUE) + labs(title="Counts by Quality of Wine") +scale_x_continuous(name="Quality of Wine", limits=c(2, 9), breaks = seq(0,10, 1)) + theme_minimal() + geom_text(aes(label=Name))
winequal
winequal <- ggplot(data=wine, aes(x=quality)) + geom_histogram(color='black', fill='#891e1e', binwidth=1, na.rm=TRUE) + labs(title="Counts by Quality of Wine") +scale_x_continuous(name="Quality of Wine", limits=c(2, 9), breaks = seq(0,10, 1)) + theme_minimal()
winequal
help(winequal)
ggplot(data=wine, aes(x=quality, label=..count..)) + geom_histogram(color='black', fill='#891e1e', binwidth=1, na.rm=TRUE) + labs(title="Counts by Quality of Wine") +scale_x_continuous(name="Quality of Wine", limits=c(2, 9), breaks = seq(0,10, 1)) + theme_minimal()
ggplot(data=wine, aes(x=quality, label=..count..)) + geom_histogram(color='black', fill='#891e1e', binwidth=1, na.rm=TRUE) + labs(title="Counts by Quality of Wine") +scale_x_continuous(name="Quality of Wine", limits=c(2, 9), breaks = seq(0,10, 1)) + theme_minimal() +  stat_bin(binwidth=1, geom="text", aes(label=..count..), vjust=-1.5)
View(melted_matrix)
